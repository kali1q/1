<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>刷题</title>
<style>
body { font-family: -apple-system, BlinkMacSystemFont; padding: 20px; background: #f7f7f7; }
.card { background: #fff; padding: 20px; border-radius: 10px; }
.option { padding: 12px; margin: 10px 0; background: #eee; border-radius: 8px; cursor: pointer; }
.option.correct { background: #c8f7c5; }
.option.wrong { background: #f7c5c5; }
button { margin-top: 15px; padding: 10px 15px; }
</style>
</head>
<body>

<div class="card">
  <h3 id="question"></h3>
  <div id="options"></div>
  <p id="analysis" style="display:none;"></p>
  <button onclick="next()">下一题</button>
</div>

<script>
let questions = [];
let index = 0;

// 简单解析 CSV
function parseCSV(text) {
  return text.trim().split('\n').slice(1).map(line => {
    const [q, o1, o2, o3, o4, answer, analysis] = line.split(',');
    return { q, options: [o1,o2,o3,o4], answer: Number(answer), analysis };
  });
}

// 加载 CSV
fetch('questions.csv')
  .then(res => res.text())
  .then(text => {
    questions = parseCSV(text);
    render();
  });

function render() {
  if (!questions.length) return;
  const q = questions[index];
  document.getElementById("question").innerText = q.q;
  const box = document.getElementById("options");
  box.innerHTML = "";
  document.getElementById("analysis").style.display = "none";

  q.options.forEach((opt, i) => {
    const div = document.createElement("div");
    div.className = "option";
    div.innerText = opt;
    div.onclick = () => check(div, i);
    box.appendChild(div);
  });
}

function check(div, i) {
  const q = questions[index];
  const options = document.querySelectorAll(".option");
  options.forEach(o => o.onclick = null);

  if (i === q.answer) div.classList.add("correct");
  else {
    div.classList.add("wrong");
    options[q.answer].classList.add("correct");
  }

  const a = document.getElementById("analysis");
  a.innerText = "解析：" + q.analysis;
  a.style.display = "block";
}

function next() {
  index = (index + 1) % questions.length;
  render();
}
</script>
</body>
</html>
